@{
    ViewData["Title"] = "Ürün Ekle";
}
<h1 class="text-center my-4">@ViewData["Title"]</h1>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form id="productForm">
                <div class="mb-3">
                    <label for="Name" class="form-label">Ürün Adı</label>
                    <input type="text" class="form-control" id="Name" name="Name" placeholder="Ürün adı girin" required>
                </div>
                <div class="mb-3">
                    <label for="Description" class="form-label">Açıklama</label>
                    <textarea class="form-control" id="Description" name="Description" rows="3" placeholder="Ürün açıklaması girin" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="Price" class="form-label">Fiyat</label>
                    <input type="number" step="0.01" class="form-control" id="Price" name="Price" placeholder="Fiyat girin" required>
                </div>
                <div class="mb-3">
                    <label for="ImageUrl" class="form-label">Ürün Resmi URL'si</label>
                    <input type="url" class="form-control" id="ImageUrl" name="ImageUrl" placeholder="Ürün resmi URL'sini girin">
                </div>
               @*  <div class="mb-3">
                    <label for="updateImage" class="form-label">Ürün Resmi</label>
                    <input type="file" class="form-control" id="updateImage" name="image">
                </div> *@
                <div class="mb-3">
                    <label for="CategoryId" class="form-label">Kategori ID</label>
                    <input type="number" class="form-control" id="CategoryId" name="CategoryId" placeholder="Kategori ID girin" required>
                </div>
                <div class="d-grid">
                    <button type="button" id="addProductBtn" class="btn btn-primary">Ürün Ekle</button>
                </div>
            </form>
            <div id="successMessage" class="alert alert-success mt-3 d-none">
                Ürün başarıyla eklendi!
            </div>
            <div id="errorMessage" class="alert alert-danger mt-3 d-none">
                Ürün eklenirken bir hata oluştu!
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $("#addProductBtn").click(function () {
        // Formdaki verileri al
        const productData = {
            name: $("#Name").val(),
            description: $("#Description").val(),
            price: parseFloat($("#Price").val()),
            imageUrl: $("#ImageUrl").val(),
            categoryId: parseInt($("#CategoryId").val())
        };

        console.log("Gönderilecek ürün:", productData); // Kontrol için

        // AJAX isteği gönder
        $.ajax({
            url: "http://localhost:5001/api/Product/add", // API'nin ürün ekleme endpoint'i
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify(productData), // Veriyi JSON formatına dönüştür
            success: function (response) {
                console.log("Ürün başarıyla eklendi:", response);
                $("#successMessage").removeClass("d-none");
                $("#errorMessage").addClass("d-none");
                $("#productForm")[0].reset(); // Formu sıfırla
            },
            error: function (err) {
                console.error("Ürün ekleme hatası:", err);
                $("#errorMessage").removeClass("d-none");
                $("#successMessage").addClass("d-none");
            }
        });
    });
</script>
